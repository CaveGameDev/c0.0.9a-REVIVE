<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft (CheerPJ)</title>
    <style>
        /* Essential styles for fullscreen rendering */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Hides scrollbars if content is slightly larger than viewport */
            width: 100%;
            height: 100%;
            background-color: #000; /* Sets background to black before the game loads */
        }
        #game-container {
            width: 100vw; /* Occupy full viewport width */
            height: 100vh; /* Occupy full viewport height */
            display: flex; /* Use flexbox for centering */
            justify-content: center; /* Center horizontally */
            align-items: center; /* Center vertically */
        }
        canvas {
            display: block; /* Ensures the canvas fills its container and avoids extra space below */
            width: 100%; /* Make canvas fill its container */
            height: 100%; /* Make canvas fill its container */
        }
    </style>
    <script src="https://cjrtnc.leaningtech.com/4.0/loader.js"></script>
</head>
<body>

    <div id="game-container">
        <canvas id="minecraft-canvas"></canvas> 
    </div>

    <script type="module">
        // Ensure the DOM is fully loaded before trying to access elements or initialize CheerPJ.
        document.addEventListener('DOMContentLoaded', async () => {
            // Tell LWJGL (through CheerPJ) which HTML canvas element to use for rendering.
            window.lwjglCanvasElement = document.getElementById('minecraft-canvas');

            // Initialize CheerPJ with debugging enabled and necessary Java properties.
            await cheerpjInit({
                enableDebug: true, // Keep this on for troubleshooting! It provides verbose console output.
                // Set the java.library.path to where CheerpJ will mount your client/ directory.
                // This tells the Java application where to look for native libraries (like those from LWJGL).
                javaProperties: ["java.library.path=/app/client"] 
            });

            // Define the classpath for Minecraft and all its dependencies.
            // REMOVED: client/lwjgl_util_applet.jar.pack.lzma
            const classPath = [
                "/app/client/minecraft.jar",           // Contains the com.mojang.minecraft.Minecraft main class
                "/app/client/lwjgl.jar.pack.lzma",     // Core LWJGL JAR
                "/app/client/jinput.jar.pack.lzma",    // JInput for input handling
                "/app/client/lwjgl_util.jar.pack.lzma",// LWJGL utility JAR
                "/app/client/res.jar.lzma",            // Resource JAR, if your Minecraft version uses it
                "/app/client/lzma.jar",                // Required by CheerpJ for .lzma decompression
                "/app/client/windows_natives.jar.lzma" // The native libraries JAR for Windows
            ].join(':'); 

            console.log("Attempting to start Minecraft main class...");
            
            try {
                // Define command-line arguments for Minecraft.
                const minecraftArgs = [
                    "-width", "854",   // Set the width
                    "-height", "480"   // Set the height
                ];

                // Execute the main class with the defined arguments.
                const exitCode = await cheerpjRunMain(
                    "com.mojang.minecraft.Minecraft", 
                    classPath,
                    ...minecraftArgs
                );
                console.log(`Minecraft exited with code: ${exitCode}`);
            } catch (e) {
                console.error("An error occurred while running Minecraft:", e);
                alert("Failed to start Minecraft. Check the browser console for details.");
            }
        });
    </script>

</body>
</html>
