<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft (CheerPJ)</title>
    <style>
        /* Essential styles for fullscreen rendering */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background-color: #000;
        }
        #game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="https://cjrtnc.leaningtech.com/4.0/loader.js"></script>
</head>
<body>

    <div id="game-container">
        <canvas id="minecraft-canvas"></canvas> 
    </div>

    <script type="module">
        // Ensure the DOM is fully loaded before trying to access elements or initialize CheerPJ.
        document.addEventListener('DOMContentLoaded', async () => {
            // Tell LWJGL (through CheerPJ) which HTML canvas element to use for rendering.
            window.lwjglCanvasElement = document.getElementById('minecraft-canvas');

            // Initialize CheerPJ with debugging enabled and necessary Java properties.
            await cheerpjInit({
                enableDebug: true,
                javaProperties: ["java.library.path=/app/client"] 
            });

            // Define the classpath for Minecraft and all its dependencies, with specific loading order.
            const classPath = [
                "/app/client/minecraft.jar",           // 1. Minecraft's main JAR (first to be loaded)
                "/app/client/lzma.jar",                // 2. LZMA decompressor (essential for other .lzma files)
                "/app/client/lwjgl.jar.pack.lzma",     // 3. Core LWJGL JAR
                "/app/client/jinput.jar.pack.lzma",    // 4. JInput for input handling
                "/app/client/lwjgl_util.jar.pack.lzma",// 5. LWJGL utility JAR
                "/app/client/res.jar.lzma",            // 6. Resource JAR, if your Minecraft version uses it
                "/app/client/windows_natives.jar.lzma" // 7. The native libraries JAR for Windows
            ].join(':'); // JARs in the classpath are separated by a colon (':').

            console.log("Attempting to start Minecraft main class...");
            
            try {
                // Define command-line arguments for Minecraft.
                const minecraftArgs = [
                    "-width", "854",   // Set the width
                    "-height", "480"   // Set the height
                ];

                // Execute the main class with the defined arguments.
                const exitCode = await cheerpjRunMain(
                    "com.mojang.minecraft.Minecraft", 
                    classPath,
                    ...minecraftArgs
                );
                console.log(`Minecraft exited with code: ${exitCode}`);
            } catch (e) {
                console.error("An error occurred while running Minecraft:", e);
                alert("Failed to start Minecraft. Check the browser console for details.");
            }
        });
    </script>

</body>
</html>
