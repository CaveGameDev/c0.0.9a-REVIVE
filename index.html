<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft (CheerPJ) - Classic Attempt</title>
    <style>
        /* Essential styles for fullscreen rendering */
        body, html {
            margin: 0;
            padding: 0;
            overflow: hidden;
            width: 100%;
            height: 100%;
            background-color: #000;
        }
        #game-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="https://cjrtnc.leaningtech.com/4.1/loader.js"></script>
</head>
<body>

    <div id="game-container">
        <canvas id="minecraft-canvas"></canvas> 
    </div>

    <script type="module">
        document.addEventListener('DOMContentLoaded', async () => {
            window.lwjglCanvasElement = document.getElementById('minecraft-canvas');

            await cheerpjInit({
                enableDebug: true, // Keep debug enabled for now for easier troubleshooting
                javaProperties: [
                    "java.library.path=/app/client", // Path where native libs are extracted by CheerpJ
                    "sun.java2d.nodraw=true",
                    "sun.awt.noerasebackground=true",
                    "sun.java2d.d3d=false",
                    "sun.java2d.opengl=false",
                    "-Djava.security.policy=/app/client/game.policy" 
                ] 
            });

            // Define the classpath for Minecraft and all its dependencies.
            // THIS LINE IS CHANGED TO USE 'minecraft.jar'
            const classPath = [
                "/app/client/minecraft.jar", // <--- CHANGED FROM my_classic_minecraft.jar
                "/app/client/windows_natives.jar",       
                "/app/client/lwjgl.jar",                 
                "/app/client/jinput.jar",                                 
            ].join(':'); 

            console.log("CheerPJ runtime initialized. Attempting to start classic Minecraft directly...");
            
            try {
                const exitCode = await cheerpjRunMain(
                    "com.mojang.minecraft.Minecraft", // Direct main class for very old Minecraft
                    classPath,
                );
                console.log(`Minecraft exited with code: ${exitCode}`);
            } catch (e) {
                console.error("Failed to start Minecraft directly:", e);
                alert(`Failed to start Minecraft. Please check the browser console for more details.`);
                if (e instanceof Error && e.message.includes("ClassNotFoundException")) {
                    console.warn("A class was not found. Check your classPath for missing or incorrectly named JARs.");
                } else if (e instanceof Error && e.message.includes("NoSuchMethodError")) {
                    console.warn("Method not found. Might be a version incompatibility between Java libraries.");
                }
            }
        });
    </script>

</body>
</html>
